<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="R. Fonner, B. Van Deynze" />

<meta name="date" content="2020-11-14" />

<title>Spatial Associations in Culvert Cost Data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">salmon_culverts</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vandeynze/salmon_culverts">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Spatial Associations in Culvert Cost Data</h1>
<h4 class="author">R. Fonner, B. Van Deynze</h4>
<h4 class="date">November 14, 2020</h4>

</div>


<p>Because of the spatial nature of the culvert worksite data, we suspect there may be different forms of spatial associations within the data. These associations may undermine the assumptions of our base OLS models. We use three tools to measure spatial heterogeneity and dependence in the cost data.</p>
<ol style="list-style-type: decimal">
<li>Variograms: these plots display how the “semivariance” (half the variance of the differences between all points within a given distance, a measure of variance within a buffer) changes as a function of distance between observations.<br />
</li>
<li>Moran’s I: this is a test of spatial autocorrelation, where a rejection of the null hypothesis indicates a violation of the OLS assumption of independent observations.</li>
<li>Anselin’s Lagrange Multiplier Tests: these tests serve as an assessment of model misspecification due to spatial associations.</li>
</ol>
<p>We use these tools on the base model found in <a href="https://vandeynze.github.io/salmon_culverts/spatial_cost_models.html">this report</a>, with one key change. After initial testing, we found including spatial fixed effects like <code>basin</code> along side band-based spatial weighting schemes (i.e. those that enforce a strict maximum distance beyond which weights are zero) can result in a singular (or at least computationally singular) model matrix. <strong>Therefore, the <code>basin</code> fixed effect is removed in the models presented and examined below.</strong></p>
<div id="variograms" class="section level1">
<h1>Variograms</h1>
<p>A variogram is used to identify the distance at which the variance within a buffer is roughly equivalent to the variance over the entire space. This distance will then be used to define which points are considered “neighbors” and which are not.</p>
<p>We construct variograms for both the dependent variable (<code>log(cost per culvert)</code>) and the model residuals to investigate spatial dependence in both costs and the model’s errors.</p>
<p><img src="figure/spatial_dependence_models.Rmd/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;" /><img src="figure/spatial_dependence_models.Rmd/unnamed-chunk-4-2.png" width="960" style="display: block; margin: auto;" /></p>
<p>These plots imply that most of the semivariance in both the dependent variable and the error term is captured within a 0.2 degree (or ~20km). We will use this as our threshold for defining which points are neighbors. We also remove 30 worksites with no neighbors (i.e. with no other worksites within 20km) to ensure suitable spatial weighting matrix structure.</p>
</div>
<div id="statistical-tests-of-spatial-dependence" class="section level1">
<h1>Statistical tests of spatial dependence</h1>
<p>We use the 20km range established using the above variograms to construct three spatial weighting matrices:</p>
<ol style="list-style-type: decimal">
<li><p><em>Distance band specification</em>: weighting matrix is zeros and ones, where <em>w<sub>ij</sub></em> = <em>w<sub>ji</sub></em> = 1 when <em>worksite_i</em> is within 20km of <em>worksite_j</em> (assumes all neighbors within buffer have equal dependence).<br />
</p></li>
<li><p><em>Inverse distance decay specification:</em> weighting matrix is <em>w<sub>ij</sub></em> = <em>w<sub>ji</sub></em> = 1/<em>d<sub>ij</sub></em> where <em>d<sub>ij</sub></em> is the distance between <em>worksite<sub>i</sub></em> and <em>worksite<sub>j</sub></em> (assumes dependence decays with distance).<br />
</p></li>
<li><p><em>Hybrid specification</em>: weights are inverse distances when worksite pair is within buffer, and zero otherwise.<br />
For each of these specifications, we estimate the core model and perform a suite of tests of spatial dependence.</p></li>
<li><p><em>Moran’s I tests</em>: these tests, performed on both the dependent variable (MoranDep) and the residuals from the model (MoranResid), identify spatial dependence, where the null is no spatial dependence (i.e., distribution over space as good as random).<br />
</p></li>
<li><p><em>Anselin’s Lagrange multiplier tests</em>: these tests of linear restrictions identify mispecification due to spatial dependence, distinguishing whether the source is due to missing spatial lags of the dependent variable or missing spatial error structure, or both. Per Anselin’s suggestion, we consider the robust tests only if both simple tests reject the null.</p>
<ul>
<li><em>LM test against error (LMerr)</em>: tests against the null of no spatial error.<br />
</li>
<li><em>LM test against lag (LMlag)</em>: tests against the null of no spatial lag structure.<br />
</li>
<li><em>Robust LM test against error (RLMerr)</em>: a version of LMerr robust to the presence of spatial lag.<br />
</li>
<li><em>Robust LM test against lag (RLMlag)</em>: a version of LMlag robust to the presence of spatial error.<br />
</li>
<li><em>LMtest against Spatial Autoregressive Moving Average (SARMA)</em>: tests against the null of neither spatial error nor spatial lag.</li>
</ul></li>
</ol>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Test statistics against spatial dependence
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Spatial weights
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Test
</th>
<th style="text-align:left;">
Band
</th>
<th style="text-align:left;">
Decay
</th>
<th style="text-align:left;">
Hybrid
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
MoranDep
</td>
<td style="text-align:left;">
22.96 (&lt;0.001)
</td>
<td style="text-align:left;">
17.69 (&lt; 0.001)
</td>
<td style="text-align:left;">
21.60 (&lt; 0.001)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MoranResid
</td>
<td style="text-align:left;">
10.27 (&lt;0.001)
</td>
<td style="text-align:left;">
12.72 (&lt; 0.001)
</td>
<td style="text-align:left;">
14.53 (&lt; 0.001)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
LMerr
</td>
<td style="text-align:left;">
83.81 (&lt;0.001)
</td>
<td style="text-align:left;">
152.51 (&lt; 0.001)
</td>
<td style="text-align:left;">
193.69 (&lt; 0.001)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
LMlag
</td>
<td style="text-align:left;">
65.04 (&lt;0.001)
</td>
<td style="text-align:left;">
150.62 (&lt; 0.001)
</td>
<td style="text-align:left;">
199.33 (&lt; 0.001)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
RLMerr
</td>
<td style="text-align:left;">
21.79 (&lt;0.001)
</td>
<td style="text-align:left;">
7.87 (0.00504)
</td>
<td style="text-align:left;">
7.38 (0.00658)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
RLMlag
</td>
<td style="text-align:left;">
3.02 (0.0822)
</td>
<td style="text-align:left;">
5.97 (0.01457)
</td>
<td style="text-align:left;">
13.03 (&lt; 0.001)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
SARMA
</td>
<td style="text-align:left;">
86.83 (&lt;0.001)
</td>
<td style="text-align:left;">
158.48 (&lt; 0.001)
</td>
<td style="text-align:left;">
206.72 (&lt; 0.001)
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> P-values in parentheses
</td>
</tr>
</tfoot>
</table>
<p>The Moran test results indicate a strong degree of spatial clustering (or “hot spots”) in both the raw dependent variable and the residuals, though the test statistic shrinks considerably in the residual, suggesting the observed explanatory variables control for a portion of this effect.</p>
<p>For all three weighting schemes, the first-stage LM tests are inconclusive, rejecting the null in all cases. For the band specification, the robust LM tests indicate a spatial error model with no spatial lag, while the hybrid specification tests suggest the inclusion of spatial lag terms. For the decay specification, we reject both tests for no spatial error and no lag, but the small test statistics suggest that this weighting scheme may be the weakest, regardless of model form. Because we observe a stronger test statistic for the RLMerr test, we choose a spatial error model without a lag term.</p>
</div>
<div id="spatial-econometric-models" class="section level1">
<h1>Spatial econometric models</h1>
<p>Here we present three Cliff-Ord type spatial models, one for each spatial weighting scheme. Based on the preceeding tests, we estimate these models with only spatial error (or spatial autocorrelation) terms for the band and decay specifications, and with a spatial lag (or spatial autoregressive) term for the hybrid specification. We estimate these models via a GMM estimator that accounts for heteroskedastic errors of unknown form (<a href="https://doi.org/10.1016/j.jeconom.2009.10.025">Kelejian and Prucha 2010</a>).</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:1200px; ">
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Spatial dependence models
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;position: sticky; top:0; background-color: #FFFFFF;" colspan="1">
</th>
<th style="empty-cells: hide;border-bottom:hidden;position: sticky; top:0; background-color: #FFFFFF;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
w/ Spatial Weights
</div>
</th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Term
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
OLS
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Band
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Decay
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Hybrid
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Intercept
</td>
<td style="text-align:center;">
9.88***<br>(1.18)
</td>
<td style="text-align:center;">
9.74***<br>(0.589)
</td>
<td style="text-align:center;">
10***<br>(0.577)
</td>
<td style="text-align:center;">
6.45***<br>(0.795)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Stream slope
</td>
<td style="text-align:center;">
-3.09*<br>(1.71)
</td>
<td style="text-align:center;">
-2.89<br>(1.77)
</td>
<td style="text-align:center;">
-2.76<br>(1.99)
</td>
<td style="text-align:center;">
-2.61<br>(1.75)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Bankfull width
</td>
<td style="text-align:center;">
-0.000706<br>(0.00605)
</td>
<td style="text-align:center;">
0.00249<br>(0.00549)
</td>
<td style="text-align:center;">
-0.00262<br>(0.00675)
</td>
<td style="text-align:center;">
-0.00072<br>(0.00584)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Stream slope X bankfull width
</td>
<td style="text-align:center;">
1.05***<br>(0.333)
</td>
<td style="text-align:center;">
1.03**<br>(0.402)
</td>
<td style="text-align:center;">
0.999**<br>(0.448)
</td>
<td style="text-align:center;">
0.922**<br>(0.384)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Road class: 3
</td>
<td style="text-align:center;">
0.592<br>(0.723)
</td>
<td style="text-align:center;">
0.565<br>(0.613)
</td>
<td style="text-align:center;">
0.418<br>(0.575)
</td>
<td style="text-align:center;">
0.67<br>(0.519)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Road class: 4
</td>
<td style="text-align:center;">
1.04*<br>(0.596)
</td>
<td style="text-align:center;">
0.93*<br>(0.523)
</td>
<td style="text-align:center;">
0.878*<br>(0.453)
</td>
<td style="text-align:center;">
0.775*<br>(0.451)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Road class: 5
</td>
<td style="text-align:center;">
0.855<br>(0.582)
</td>
<td style="text-align:center;">
0.757<br>(0.491)
</td>
<td style="text-align:center;">
0.852**<br>(0.412)
</td>
<td style="text-align:center;">
0.736*<br>(0.412)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Road paved (dummy)
</td>
<td style="text-align:center;">
0.359***<br>(0.0712)
</td>
<td style="text-align:center;">
0.342***<br>(0.0739)
</td>
<td style="text-align:center;">
0.405***<br>(0.0901)
</td>
<td style="text-align:center;">
0.301***<br>(0.0756)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Terrain slope
</td>
<td style="text-align:center;">
-0.0463***<br>(0.0141)
</td>
<td style="text-align:center;">
-0.043***<br>(0.0128)
</td>
<td style="text-align:center;">
-0.0475***<br>(0.0164)
</td>
<td style="text-align:center;">
-0.0431***<br>(0.0128)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Developed
</td>
<td style="text-align:center;">
-1.1<br>(0.996)
</td>
<td style="text-align:center;">
-0.713***<br>(0.232)
</td>
<td style="text-align:center;">
-0.711***<br>(0.247)
</td>
<td style="text-align:center;">
-0.518***<br>(0.145)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Forest
</td>
<td style="text-align:center;">
-1.48<br>(0.997)
</td>
<td style="text-align:center;">
-1.08***<br>(0.235)
</td>
<td style="text-align:center;">
-1.07***<br>(0.251)
</td>
<td style="text-align:center;">
-0.821***<br>(0.154)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Herbaceous
</td>
<td style="text-align:center;">
-1.44<br>(1.01)
</td>
<td style="text-align:center;">
-1.13***<br>(0.264)
</td>
<td style="text-align:center;">
-1.23***<br>(0.282)
</td>
<td style="text-align:center;">
-0.871***<br>(0.182)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Planted-cultivated
</td>
<td style="text-align:center;">
-1.12<br>(1)
</td>
<td style="text-align:center;">
-0.81***<br>(0.259)
</td>
<td style="text-align:center;">
-0.85***<br>(0.275)
</td>
<td style="text-align:center;">
-0.65***<br>(0.179)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Shrubland
</td>
<td style="text-align:center;">
-1.19<br>(1)
</td>
<td style="text-align:center;">
-0.848***<br>(0.257)
</td>
<td style="text-align:center;">
-0.881***<br>(0.273)
</td>
<td style="text-align:center;">
-0.6***<br>(0.184)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Water
</td>
<td style="text-align:center;">
-1.4<br>(1.09)
</td>
<td style="text-align:center;">
-1.11***<br>(0.396)
</td>
<td style="text-align:center;">
-1.07***<br>(0.328)
</td>
<td style="text-align:center;">
-0.858***<br>(0.257)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Land cover: Wetlands
</td>
<td style="text-align:center;">
-1.3<br>(1)
</td>
<td style="text-align:center;">
-0.908***<br>(0.249)
</td>
<td style="text-align:center;">
-0.857***<br>(0.26)
</td>
<td style="text-align:center;">
-0.707***<br>(0.164)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Housing density
</td>
<td style="text-align:center;">
-0.000566<br>(0.0012)
</td>
<td style="text-align:center;">
0.000732<br>(0.00111)
</td>
<td style="text-align:center;">
0.000673<br>(0.00124)
</td>
<td style="text-align:center;">
0.000826<br>(0.00108)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Ag/forestry employment
</td>
<td style="text-align:center;">
0.0000718<br>(0.0000601)
</td>
<td style="text-align:center;">
0.0000241<br>(0.0000937)
</td>
<td style="text-align:center;">
0.0000269<br>(0.0000923)
</td>
<td style="text-align:center;">
-0.00000824<br>(0.0000684)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Construction employment
</td>
<td style="text-align:center;">
0.00000221<br>(0.0000067)
</td>
<td style="text-align:center;">
0.0000035<br>(0.0000106)
</td>
<td style="text-align:center;">
0.00000831<br>(0.0000087)
</td>
<td style="text-align:center;">
0.00000756<br>(0.00000797)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Number of culverts
</td>
<td style="text-align:center;">
-0.0793***<br>(0.0121)
</td>
<td style="text-align:center;">
-0.107***<br>(0.0114)
</td>
<td style="text-align:center;">
-0.107***<br>(0.0115)
</td>
<td style="text-align:center;">
-0.0835***<br>(0.0123)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Mean distance between work sites, log
</td>
<td style="text-align:center;">
0.0259<br>(0.0279)
</td>
<td style="text-align:center;">
0.036<br>(0.025)
</td>
<td style="text-align:center;">
-0.00947<br>(0.0317)
</td>
<td style="text-align:center;">
0.00457<br>(0.0246)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Single work site (dummy)
</td>
<td style="text-align:center;">
0.572***<br>(0.169)
</td>
<td style="text-align:center;">
0.55***<br>(0.151)
</td>
<td style="text-align:center;">
0.291<br>(0.21)
</td>
<td style="text-align:center;">
0.344**<br>(0.147)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Culvert installation (dummy)
</td>
<td style="text-align:center;">
0.337**<br>(0.132)
</td>
<td style="text-align:center;">
0.285**<br>(0.115)
</td>
<td style="text-align:center;">
0.341***<br>(0.106)
</td>
<td style="text-align:center;">
0.277***<br>(0.102)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Culvert removal (dummy)
</td>
<td style="text-align:center;">
-0.0505<br>(0.0778)
</td>
<td style="text-align:center;">
-0.0378<br>(0.0889)
</td>
<td style="text-align:center;">
-0.00268<br>(0.0962)
</td>
<td style="text-align:center;">
-0.00791<br>(0.0872)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Project source: BLM
</td>
<td style="text-align:center;">
0.931***<br>(0.113)
</td>
<td style="text-align:center;">
0.86***<br>(0.109)
</td>
<td style="text-align:center;">
0.723***<br>(0.0975)
</td>
<td style="text-align:center;">
0.619***<br>(0.0926)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Project source: HABITAT WORK SCHEDULE
</td>
<td style="text-align:center;">
1.31***<br>(0.183)
</td>
<td style="text-align:center;">
1.17***<br>(0.22)
</td>
<td style="text-align:center;">
1.1***<br>(0.21)
</td>
<td style="text-align:center;">
0.875***<br>(0.204)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Project source: REO
</td>
<td style="text-align:center;">
0.853***<br>(0.0826)
</td>
<td style="text-align:center;">
0.851***<br>(0.0861)
</td>
<td style="text-align:center;">
0.724***<br>(0.0965)
</td>
<td style="text-align:center;">
0.635***<br>(0.0845)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Project source: SRFBD
</td>
<td style="text-align:center;">
1.46***<br>(0.232)
</td>
<td style="text-align:center;">
1.35***<br>(0.216)
</td>
<td style="text-align:center;">
1.35***<br>(0.242)
</td>
<td style="text-align:center;">
1.22***<br>(0.23)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Project source: WA RCO
</td>
<td style="text-align:center;">
0.824***<br>(0.121)
</td>
<td style="text-align:center;">
0.64***<br>(0.18)
</td>
<td style="text-align:center;">
0.731***<br>(0.148)
</td>
<td style="text-align:center;">
0.406**<br>(0.168)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2002
</td>
<td style="text-align:center;">
0.216*<br>(0.111)
</td>
<td style="text-align:center;">
0.0735<br>(0.108)
</td>
<td style="text-align:center;">
0.0926<br>(0.128)
</td>
<td style="text-align:center;">
0.0784<br>(0.108)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2003
</td>
<td style="text-align:center;">
0.292**<br>(0.12)
</td>
<td style="text-align:center;">
0.283**<br>(0.125)
</td>
<td style="text-align:center;">
0.375***<br>(0.138)
</td>
<td style="text-align:center;">
0.274**<br>(0.116)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2004
</td>
<td style="text-align:center;">
0.636***<br>(0.119)
</td>
<td style="text-align:center;">
0.55***<br>(0.11)
</td>
<td style="text-align:center;">
0.482***<br>(0.123)
</td>
<td style="text-align:center;">
0.472***<br>(0.11)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2005
</td>
<td style="text-align:center;">
0.438***<br>(0.119)
</td>
<td style="text-align:center;">
0.347***<br>(0.118)
</td>
<td style="text-align:center;">
0.222<br>(0.143)
</td>
<td style="text-align:center;">
0.296**<br>(0.119)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2006
</td>
<td style="text-align:center;">
0.583***<br>(0.125)
</td>
<td style="text-align:center;">
0.435***<br>(0.136)
</td>
<td style="text-align:center;">
0.385**<br>(0.154)
</td>
<td style="text-align:center;">
0.393***<br>(0.133)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2007
</td>
<td style="text-align:center;">
0.582***<br>(0.136)
</td>
<td style="text-align:center;">
0.534***<br>(0.134)
</td>
<td style="text-align:center;">
0.388**<br>(0.152)
</td>
<td style="text-align:center;">
0.433***<br>(0.133)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2008
</td>
<td style="text-align:center;">
-0.095<br>(0.223)
</td>
<td style="text-align:center;">
0.0364<br>(0.248)
</td>
<td style="text-align:center;">
-0.194<br>(0.294)
</td>
<td style="text-align:center;">
0.0366<br>(0.262)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2009
</td>
<td style="text-align:center;">
0.305<br>(0.202)
</td>
<td style="text-align:center;">
0.211<br>(0.195)
</td>
<td style="text-align:center;">
0.00983<br>(0.225)
</td>
<td style="text-align:center;">
0.104<br>(0.162)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2010
</td>
<td style="text-align:center;">
0.325<br>(0.198)
</td>
<td style="text-align:center;">
0.269<br>(0.176)
</td>
<td style="text-align:center;">
0.27<br>(0.178)
</td>
<td style="text-align:center;">
0.183<br>(0.171)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2011
</td>
<td style="text-align:center;">
0.143<br>(0.193)
</td>
<td style="text-align:center;">
0.0369<br>(0.195)
</td>
<td style="text-align:center;">
0.0236<br>(0.212)
</td>
<td style="text-align:center;">
0.0527<br>(0.197)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2012
</td>
<td style="text-align:center;">
0.0225<br>(0.235)
</td>
<td style="text-align:center;">
0.0712<br>(0.241)
</td>
<td style="text-align:center;">
0.025<br>(0.246)
</td>
<td style="text-align:center;">
0.012<br>(0.224)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2013
</td>
<td style="text-align:center;">
0.128<br>(0.198)
</td>
<td style="text-align:center;">
0.088<br>(0.242)
</td>
<td style="text-align:center;">
0.0265<br>(0.254)
</td>
<td style="text-align:center;">
0.0393<br>(0.252)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2014
</td>
<td style="text-align:center;">
0.0879<br>(0.243)
</td>
<td style="text-align:center;">
0.168<br>(0.246)
</td>
<td style="text-align:center;">
0.0292<br>(0.263)
</td>
<td style="text-align:center;">
0.0567<br>(0.248)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Year: 2015
</td>
<td style="text-align:center;">
-0.45*<br>(0.262)
</td>
<td style="text-align:center;">
-0.172<br>(0.25)
</td>
<td style="text-align:center;">
0.0718<br>(0.267)
</td>
<td style="text-align:center;">
-0.154<br>(0.254)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Lambda (lag parameter)
</td>
<td style="text-align:center;">
‒
</td>
<td style="text-align:center;">
‒
</td>
<td style="text-align:center;">
‒
</td>
<td style="text-align:center;">
0.326***<br>(0.0601)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Rho (error parameter)
</td>
<td style="text-align:center;">
‒
</td>
<td style="text-align:center;">
0.468***<br>(0.0451)
</td>
<td style="text-align:center;">
0.9***<br>(0.107)
</td>
<td style="text-align:center;">
0.303***<br>(0.0744)
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01
</td>
</tr>
</tfoot>
</table>
</div>
<p>The point estimates and standard errors for the primary coefficients and fixed effects are roughly equivalent. Interestingly, accounting for spatial dependence results ins much more tightly estimated land cover parameters. And the pattern of increased costs on smaller roads (after accounting for paved status) is more pronounced.</p>
<p>All spatial dependence parameters are positive and statistically significant, indicating positive spatial spillovers in the both the error and, in the case of the hybrid weights matrix, nearby costs. One cause of positive spillover in the errors may be missing explanatory variables that affect costs at a geographic scale that encompasses other worksites within range of the weighting scheme (e.g. the band distance). The positive lambda indicates that more expensive worksites in one location drive up costs nearby. A possible mechanism may be competition for scarce resources (e.g. labor, machinery, etc.).</p>
</div>
<div id="closing-thoughts" class="section level1">
<h1>Closing Thoughts</h1>
<p>The most obvious drawback of this entire spatial dependence examination, at this stage, is that none of our weighting matrices nor our models account for spatio-temporal dynamics. That is, the current spatial weighting scheme includes all projects, both in the past and in the future. Preliminary examination of the literature on dynamic spatial econometric models is underway, and will likely involve regenerating the weight matrices in a way that only include contemporaneous and/or past worksites. This adds degrees of freedom in how these matrices are constructed, as the lag over which past worksites are included, and the degree to which they influence the spatial effect, must be selected or estimated.</p>
<p>Additional next steps will include developing methods for comparing model fit (GMM does not lend itself well to typical likelihood-based measures like AIC or R-squared). Initial ideas include comparing mean squared error or sum of absolute error using bootstraping methods. I’ll also need to find or build methods for computing marginal effects for continuous variables and prediction. Prediction for spatial econometric models can be quite complicated due to spillovers, so this is something we’ll need to be careful with. It might be that these models are more useful for inference and the simpler OLS-based models can be used for prediction.</p>
<p>Overall, the spatial econometric methods have little effect on inference regarding the explanatory variables. However, their inclusion does account for an additional source of unobserved variance in the OLS models, while the specific GMM methodology provides robustness against heteroskedastic errors. The spatial parameters themselves provide additional richness to the interpretation of the model.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18363)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] sphet_1.7        fields_11.6      spam_2.5-1       dotCall64_1.0-0 
 [5] spdep_1.1-5      sf_0.9-6         spData_0.3.8     sp_1.4-4        
 [9] geoR_1.8-1       readxl_1.3.1     ggeffects_0.16.0 margins_0.3.23  
[13] broom_0.7.2      kableExtra_1.3.1 knitr_1.30       scales_1.1.1    
[17] here_0.1         janitor_2.0.1    forcats_0.5.0    stringr_1.4.0   
[21] dplyr_1.0.2      purrr_0.3.4      readr_1.4.0      tidyr_1.1.2     
[25] tibble_3.0.4     ggplot2_3.3.2    tidyverse_1.3.0  workflowr_1.6.2 

loaded via a namespace (and not attached):
 [1] colorspace_1.4-1        deldir_0.1-29           ellipsis_0.3.1         
 [4] class_7.3-17            sjlabelled_1.1.7        rprojroot_1.3-2        
 [7] snakecase_0.11.0        fs_1.5.0                rstudioapi_0.11        
[10] fansi_0.4.1             lubridate_1.7.9         xml2_1.3.2             
[13] codetools_0.2-16        splines_4.0.2           jsonlite_1.7.1         
[16] dbplyr_1.4.4            compiler_4.0.2          httr_1.4.2             
[19] backports_1.1.10        assertthat_0.2.1        Matrix_1.2-18          
[22] cli_2.1.0               later_1.1.0.1           htmltools_0.5.0        
[25] tools_4.0.2             coda_0.19-4             gtable_0.3.0           
[28] glue_1.4.2              maps_3.3.0              gmodels_2.18.1         
[31] Rcpp_1.0.5              cellranger_1.1.0        raster_3.3-13          
[34] vctrs_0.3.4             gdata_2.18.0            nlme_3.1-148           
[37] insight_0.10.0          xfun_0.18               ps_1.4.0               
[40] rvest_0.3.6             lifecycle_0.2.0         gtools_3.8.2           
[43] LearnBayes_2.15.1       MASS_7.3-51.6           hms_0.5.3              
[46] promises_1.1.1          expm_0.999-5            yaml_2.2.1             
[49] stringi_1.5.3           highr_0.8               e1071_1.7-4            
[52] RandomFieldsUtils_0.5.3 boot_1.3-25             rlang_0.4.8            
[55] pkgconfig_2.0.3         evaluate_0.14           lattice_0.20-41        
[58] prediction_0.3.14       tidyselect_1.1.0        magrittr_1.5           
[61] R6_2.4.1                generics_0.0.2          DBI_1.1.0              
[64] pillar_1.4.6            haven_2.3.1             withr_2.3.0            
[67] units_0.6-7             modelr_0.1.8            crayon_1.3.4           
[70] utf8_1.1.4              KernSmooth_2.23-17      rmarkdown_2.5          
[73] RandomFields_3.3.8      data.table_1.13.2       blob_1.2.1             
[76] git2r_0.27.1            splancs_2.01-40         reprex_0.3.0           
[79] digest_0.6.26           classInt_0.4-3          webshot_0.5.2          
[82] httpuv_1.5.4            munsell_0.5.0           viridisLite_0.3.0      
[85] tcltk_4.0.2            </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
